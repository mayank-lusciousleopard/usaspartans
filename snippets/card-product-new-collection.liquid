{% comment %}
  Renders a product card

  Accepts:
  - card_product: {Object} Product Liquid object (optional)
  - media_aspect_ratio: {String} Size of the product image card. Values are "square" and "portrait". Default is "square" (optional)
  - show_secondary_image: {Boolean} Show the secondary image on hover. Default: false (optional)
  - show_vendor: {Boolean} Show the product vendor. Default: false
  - show_rating: {Boolean} Show the product rating. Default: false
  - extend_height: {Boolean} Card height extends to available container space. Default: true (optional)
  - lazy_load: {Boolean} Image should be lazy loaded. Default: true (optional)
  - show_quick_add: {Boolean} Show the quick add button.
  - section_id: {String} The ID of the section that contains this card.
  - horizontal_class: {Boolean} Add a card--horizontal class if set to true. Default: false (optional)
  - horizontal_quick_add: {Boolean} Changes the quick add button styles when set to true. Default: false (optional)

  Usage:
  {% render 'card-product', show_vendor: section.settings.show_vendor %}
{% endcomment %}

<style>
  {% if shop_now_button %}
    {% comment %} .button-hover-container {
      display: none !important;
    }

    .card-container:hover .button-hover-container {
      display: none !important;
      opacity: 0;
    } {% endcomment %}

    .card:hover .media.image-container > img:first-child:only-child,
    .card-wrapper:hover .media.image-container > img:first-child:only-child {
      filter: blur(0px);
    }

    .card {
      justify-content: space-between !important;
    }

  {% else %}
    .card-container {
      position: relative !important;
    }

    {% comment %} .button-hover-container {
      display: none !important;
      position: absolute;
      z-index: 9999;
      opacity: 0;
      transition: opacity 0.5s ease, top 0.3s ease !important;
    }

    .card-container:hover .button-hover-container {
      top: 25% !important;
      display: flex !important;
      align-self: center;
      justify-content: center !important;
      margin: 0 auto;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      opacity: 1;
    } {% endcomment %}

    .card:hover .media.image-container > img:first-child:only-child,
    .card-wrapper:hover .media.image-container > img:first-child:only-child {
      filter: blur(2px);
    }
  {% endif %}

  .c-sn-button {
    padding: 1em 2em;
    font-size: 1em;
    gap: 0.625rem;
    border-radius: 0.8em;
    opacity: 1;
    background: linear-gradient(90deg, #0E83F9 0%, #084D93 100%);
    color: white;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 10px auto;
    max-width: 90%;
    text-align: center;
  }

  .c-sn-button:hover {
    background:linear-gradient(90deg, #084D93 0%, #084D93 100%) !important;
  }


  @media screen and (max-width: 760px) {
    .card-container:hover .button-hover-container {
      {% comment %} display: none !important; {% endcomment %}

    }
    .card:hover .media.image-container > img:first-child:only-child,
    .card-wrapper:hover .media.image-container > img:first-child:only-child {
      filter: blur(0px);
    }
  }
</style>

{{ 'component-rating.css' | asset_url | stylesheet_tag }}

{%- if card_product and card_product != empty -%}
  {%- liquid
    assign ratio = 1
    if card_product.featured_media and media_aspect_ratio == 'portrait'
      assign ratio = 0.8
    elsif card_product.featured_media and media_aspect_ratio == 'adapt'
      assign ratio = card_product.featured_media.aspect_ratio
    endif
    if ratio == 0 or ratio == null
      assign ratio = 1
    endif
  -%}
  <div class="card-wrapper product-card-wrapper underline-links-hover card-container">
    <div
      class="
        card
        card--{{ settings.card_style }}
        {% if card_product.featured_media %} card--media{% else %} card--text{% endif %}
        {% if settings.card_style == 'card' %} color-{{ settings.card_color_scheme }} gradient{% endif %}
        {% if extend_height %} card--extend-height{% endif %}
        {% if card_product.featured_media == nil and settings.card_style == 'card' %} ratio{% endif %}
        {% if horizontal_class %} card--horizontal{% endif %}
      "
      style="--ratio-percent: {{ 1 | divided_by: ratio | times: 100 }}%;"
    >
      <div
        class="card__inner {% if settings.card_style == 'standard' %}color-{{ settings.card_color_scheme }} gradient{% endif %}{% if card_product.featured_media or settings.card_style == 'standard' %} ratio{% endif %}"
        style="--ratio-percent: {{ 1 | divided_by: ratio | times: 100 }}%;"
      >

        {% if settings.show_q4_sale and settings.sale_q4_badge_label != blank %}
          <div class="q4-sale-badge-container">
            {% render 'q4-badge' %}
          </div>
        {% endif %}
        
        {%- if card_product.featured_media -%}
          <div class="card__media">
            <div class="media media--transparent media--hover-effect image-container">
              {% comment %}theme-check-disable ImgLazyLoading{% endcomment %}
              <img
                srcset="
                  {%- if card_product.featured_media.width >= 165 -%}{{ card_product.featured_media | image_url: width: 165 }} 165w,{%- endif -%}
                  {%- if card_product.featured_media.width >= 360 -%}{{ card_product.featured_media | image_url: width: 360 }} 360w,{%- endif -%}
                  {%- if card_product.featured_media.width >= 533 -%}{{ card_product.featured_media | image_url: width: 533 }} 533w,{%- endif -%}
                  {%- if card_product.featured_media.width >= 720 -%}{{ card_product.featured_media | image_url: width: 720 }} 720w,{%- endif -%}
                  {%- if card_product.featured_media.width >= 940 -%}{{ card_product.featured_media | image_url: width: 940 }} 940w,{%- endif -%}
                  {%- if card_product.featured_media.width >= 1066 -%}{{ card_product.featured_media | image_url: width: 1066 }} 1066w,{%- endif -%}
                  {{ card_product.featured_media | image_url }} {{ card_product.featured_media.width }}w
                "
                src="{{ card_product.featured_media | image_url: width: 533 }}"
                sizes="(min-width: {{ settings.page_width }}px) {{ settings.page_width | minus: 130 | divided_by: 4 }}px, (min-width: 990px) calc((100vw - 130px) / 4), (min-width: 750px) calc((100vw - 120px) / 3), calc((100vw - 35px) / 2)"
                alt="{{ card_product.featured_media.alt | escape }}"
                class="motion-reduce"
                {% unless lazy_load == false %}
                  loading="lazy"
                {% endunless %}
                width="{{ card_product.featured_media.width }}"
                height="{{ card_product.featured_media.height }}"
              >
              {% comment %}theme-check-enable ImgLazyLoading{% endcomment %}

              {%- if card_product.media[1] != null and show_secondary_image -%}
                <img
                  srcset="
                    {%- if card_product.media[1].width >= 165 -%}{{ card_product.media[1] | image_url: width: 165 }} 165w,{%- endif -%}
                    {%- if card_product.media[1].width >= 360 -%}{{ card_product.media[1] | image_url: width: 360 }} 360w,{%- endif -%}
                    {%- if card_product.media[1].width >= 533 -%}{{ card_product.media[1] | image_url: width: 533 }} 533w,{%- endif -%}
                    {%- if card_product.media[1].width >= 720 -%}{{ card_product.media[1] | image_url: width: 720 }} 720w,{%- endif -%}
                    {%- if card_product.media[1].width >= 940 -%}{{ card_product.media[1] | image_url: width: 940 }} 940w,{%- endif -%}
                    {%- if card_product.media[1].width >= 1066 -%}{{ card_product.media[1] | image_url: width: 1066 }} 1066w,{%- endif -%}
                    {{ card_product.media[1] | image_url }} {{ card_product.media[1].width }}w
                  "
                  src="{{ card_product.media[1] | image_url: width: 533 }}"
                  sizes="(min-width: {{ settings.page_width }}px) {{ settings.page_width | minus: 130 | divided_by: 4 }}px, (min-width: 990px) calc((100vw - 130px) / 4), (min-width: 750px) calc((100vw - 120px) / 3), calc((100vw - 35px) / 2)"
                  alt=""
                  class="motion-reduce"
                  loading="lazy"
                  width="{{ card_product.media[1].width }}"
                  height="{{ card_product.media[1].height }}"
                >
              {%- endif -%}
            </div>
          </div>
        {%- endif -%}
        <div class="card__content">
          <div class="card__information">
            <h3
              class="card__heading"
              {% if card_product.featured_media == null and settings.card_style == 'standard' %}
                id="title-{{ section_id }}-{{ card_product.id }}"
              {% endif %}
            >
              <a
                href="{{ card_product.url }}"
                id="StandardCardNoMediaLink-{{ section_id }}-{{ card_product.id }}"
                class="full-unstyled-link"
                aria-labelledby="StandardCardNoMediaLink-{{ section_id }}-{{ card_product.id }} NoMediaStandardBadge-{{ section_id }}-{{ card_product.id }}"
              >
                {{ card_product.title | escape }}
              </a>
            </h3>
          </div>
          <div class="card__badge {{ settings.badge_position }}">
            {%- if card_product.available == false -%}
              <span
                id="NoMediaStandardBadge-{{ section_id }}-{{ card_product.id }}"
                class="badge badge--bottom-left color-{{ settings.sold_out_badge_color_scheme }}"
              >
                {{- 'products.product.sold_out' | t -}}
              </span>
            {%- elsif card_product.compare_at_price > card_product.price and card_product.available -%}
              {% assign q4_discount_percentage = settings.sale_q4_discount_amount %}
              {% assign base_price = card_product.price %}
              {% assign compare_at = card_product.compare_at_price %}
              {% comment %} {% if settings.show_q4_sale and q4_discount_percentage > 0 %}
                {% assign q4_extra_discount = base_price | times: q4_discount_percentage | divided_by: 100 %}
                {% assign q4_discounted_price = base_price | minus: q4_extra_discount %}
                {% assign savings_base = base_price %}
                {% if compare_at > base_price %}
                  {% assign savings_base = compare_at %}
                {% endif %}
                {% assign total_savings = savings_base | minus: q4_discounted_price %}
              {% else %}
                {% assign total_savings = compare_at | minus: base_price %}
                {% endif %} {% endcomment %}
              {% assign total_savings = compare_at | minus: base_price %}
              <span
                id="NoMediaStandardBadge-{{ section_id }}-{{ card_product.id }}"
                class="badge badge--bottom-left color-{{ settings.sale_badge_color_scheme }} !tw-bg-[#EC860E] !tw-text-white !tw-rounded-[7px] !tw-border-none !tw-p-2 !tw-font-bold"
              >
                SAVE&nbsp;{{ total_savings | money }}
              </span>
            {%- endif -%}
          </div>
        </div>
      </div>
      <div class="card__content">
        <div class="card__information">
          <h3
            class="card__heading{% if card_product.featured_media or settings.card_style == 'standard' %} h5{% endif %}"
            {% if card_product.featured_media or settings.card_style == 'card' %}
              id="title-{{ section_id }}-{{ card_product.id }}"
            {% endif %}
          >
            <a
              href="{{ card_product.url }}"
              id="CardLink-{{ section_id }}-{{ card_product.id }}"
              class="full-unstyled-link"
              aria-labelledby="CardLink-{{ section_id }}-{{ card_product.id }} Badge-{{ section_id }}-{{ card_product.id }}"
            >
              {{ card_product.title | escape }}
            </a>
          </h3>
          <div class="jdgm-widget jdgm-preview-badge !tw-pb-3 !tw-text-sm " data-id="{{ card_product.id }}">
            {{ card_product.metafields.judgeme.badge }}
          </div>
          <div class="card-information">
            {%- if show_vendor -%}
              <span class="visually-hidden">{{ 'accessibility.vendor' | t }}</span>
              <div class="caption-with-letter-spacing light">{{ card_product.vendor }}</div>
            {%- endif -%}

            <span class="caption-large light">{{ block.settings.description | escape }}</span>
            {% if card_product.handle contains 'sauna' %}
              <div class="badge-for-preorder">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none">
  <g clip-path="url(#clip0_756_155)">
    <path d="M3.80762 5.08599C4.93962 4.07999 5.64162 3.73999 6.99962 3.48999C8.35762 3.74099 9.05962 4.07999 10.1916 5.08599L6.99962 6.68199L3.80762 5.08599Z" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M6.99993 6.674V10.405M3.80793 5.086C3.41493 6.166 3.41093 7.454 3.72293 8.539C3.77543 8.71686 3.8799 8.87496 4.02293 8.993C5.01093 9.817 5.68693 10.12 6.78893 10.361C6.928 10.391 7.07187 10.391 7.21093 10.361C8.31293 10.12 8.98893 9.817 9.97593 8.993C10.1193 8.8751 10.2242 8.71698 10.2769 8.539C10.5889 7.454 10.5849 6.166 10.1919 5.086L6.99993 6.682L3.80793 5.086Z" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M0.75 6.99998C0.749463 5.60859 1.21323 4.25681 2.06782 3.1588C2.92241 2.06079 4.11896 1.27934 5.4679 0.938258C6.81683 0.597179 8.24101 0.715974 9.51479 1.27582C10.7886 1.83567 11.8391 2.80456 12.5 4.02898C12.576 2.92698 12.553 2.29698 12.4 1.15398M13.25 6.99998C13.2504 8.38845 12.7885 9.73754 11.9371 10.8344C11.0857 11.9312 9.89333 12.7132 8.54812 13.0572C7.20292 13.4011 5.78148 13.2873 4.50814 12.7337C3.23479 12.1801 2.18203 11.2183 1.516 9.99998C1.44 11.102 1.462 11.732 1.616 12.875" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
  </g>
  <defs>
    <clipPath id="clip0_756_155">
      <rect width="14" height="14" fill="white"/>
    </clipPath>
  </defs>
</svg>
<p>Estimated delivery time 1 month</p>
              </div>
            {% endif %}
            <div class="price-container sadfsdfsdf">
              {% comment %}
              {% render 'price', product: card_product, price_class: '' %}
               {% endcomment %}
                {% comment %} Custom Price Box {% endcomment %}
            <div class="custom_price_box" style="margin-top: 5px;">
              {%- assign target_variant = card_product.first_available_variant -%}
              {%- if target_variant -%}
                  <div style="display: flex; align-items: center; flex-wrap: wrap; gap: 8px;">
                    {%- if target_variant.compare_at_price > target_variant.price -%}
                      <span style="text-decoration: line-through; color: #A3A3A3;">
                        {{ target_variant.compare_at_price | money }}
                      </span>
                      <span style="font-weight: bold; color: #171717; font-size: 1.1em;">
                        {{ target_variant.price | money }}
                      </span>
                      <span style="background-color: #E5E5E5; color: #404040; padding: 2px 6px; font-size: 0.85em; font-weight: 500; border-radius: 2px;">
                        {{ target_variant.compare_at_price | minus: target_variant.price | times: 100.0 | divided_by: target_variant.compare_at_price | round }}% OFF
                      </span>
                    {%- else -%}
                       <span style="font-weight: bold; color: rgb(var(--color-foreground)); font-size: 1.1em;">
                        {{ target_variant.price | money }}
                      </span>
                    {%- endif -%}
                  </div>
              {%- else -%}
                  {% comment %} Fallback for products with no available variants (e.g. sold out) {% endcomment %}
                  <div style="display: flex; align-items: center; flex-wrap: wrap; gap: 8px;">
                     <span style="font-weight: bold; color: rgb(var(--color-foreground)); font-size: 1.1em;">
                        {{ card_product.price | money }}
                      </span>
                  </div>
              {%- endif -%}
            </div>

              {%- if card_product.variants.size > 1 or qty_rules -%}
                <modal-opener data-modal="#QuickAdd-{{ card_product.id }}">
                  <button
                    id="{{ product_form_id }}-submit"
                    type="submit"
                    name="add"
                    class="quick-add__submit button button--full-width button--secondary{% if horizontal_quick_add %} card--horizontal__quick-add animate-arrow{% endif %}"
                    aria-haspopup="dialog"
                    aria-labelledby="{{ product_form_id }}-submit title-{{ section_id }}-{{ card_product.id }}"
                    data-product-url="{{ card_product.url }}"
                    data-schoose
                  >
                    <span>{{ 'products.product.choose_options' | t }}</span>
                    {%- if horizontal_quick_add -%}
                      <span class="icon-wrap">{% render 'icon-arrow' %}</span>
                    {%- endif -%}
                    <div class="loading-overlay__spinner hidden">
                      <svg
                        aria-hidden="true"
                        focusable="false"
                        class="spinner"
                        viewBox="0 0 66 66"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <circle class="path" fill="none" stroke-width="6" cx="33" cy="33" r="30"></circle>
                      </svg>
                    </div>
                  </button>
                </modal-opener>
                <quick-add-modal id="QuickAdd-{{ card_product.id }}" class="quick-add-modal">
                  <div
                    role="dialog"
                    aria-label="{{ 'products.product.choose_product_options' | t: product_name: card_product.title | escape }}"
                    aria-modal="true"
                    class="quick-add-modal__content global-settings-popup"
                    tabindex="-1"
                  >
                    <button
                      id="ModalClose-{{ card_product.id }}"
                      type="button"
                      class="quick-add-modal__toggle"
                      aria-label="{{ 'accessibility.close' | t }}"
                    >
                      {% render 'icon-close' %}
                    </button>
                    <div id="QuickAddInfo-{{ card_product.id }}" class="quick-add-modal__content-info"></div>
                  </div>
                </quick-add-modal>
              {%- else -%}
                <product-form>
                  {%- form 'product',
                    card_product,
                    id: product_form_id,
                    class: 'form',
                    novalidate: 'novalidate',
                    data-type: 'add-to-cart-form'
                  -%}
                    <input
                      type="hidden"
                      name="id"
                      value="{{ card_product.selected_or_first_available_variant.id }}"
                      disabled
                    >
                    <button
                      id="{{ product_form_id }}-submit"
                      type="submit"
                      name="add"
                      class="quick-add__submit button button--full-width button--secondary{% if horizontal_quick_add %} card--horizontal__quick-add{% endif %}"
                      aria-haspopup="dialog"
                      aria-labelledby="{{ product_form_id }}-submit title-{{ section_id }}-{{ card_product.id }}"
                      aria-live="polite"
                      data-atc
                      data-sold-out-message="true"
                      {% if card_product.selected_or_first_available_variant.available == false %}
                        disabled
                      {% endif %}
                    >
                      <span>
                        {%- if card_product.selected_or_first_available_variant.available -%}
                          Add to Cart
                        {%- else -%}
                          {{ 'products.product.sold_out' | t }}
                        {%- endif -%}
                      </span>
                      <span class="sold-out-message hidden">
                        {{ 'products.product.sold_out' | t }}
                      </span>
                      {%- if horizontal_quick_add -%}
                        <span class="icon-wrap">{% render 'icon-plus' %}</span>
                      {%- endif -%}
                      <div class="loading-overlay__spinner hidden">
                        <svg
                          aria-hidden="true"
                          focusable="false"
                          class="spinner"
                          viewBox="0 0 66 66"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <circle class="path" fill="none" stroke-width="6" cx="33" cy="33" r="30"></circle>
                        </svg>
                      </div>
                    </button>
                  {%- endform -%}
                </product-form>
              {%- endif -%}
            </div>
          </div>
          {% if shop_now_button %}
            <div class="shop-now-button">
              <a href="{{ product.url }}" class="c-sn-button"> Shop Now </a>
            </div>
          {% endif %}
          <div class="button-hover-container">
      {%- assign product_form_id = 'product-form-' | append: section.id -%}
      {%- render 'buy-buttons',
        product: card_product,
        product_form_id: product_form_id,
        section_id: section.id,
        show_pickup_availability: true,
        custom_classes: 'md:tw-py-4 md:tw-px-[40px] tw-p-2 tw-gap-2.5 tw-rounded-[10px] tw-opacity-100 tw-bg-custom-gradient tw-text-white md:tw-text-[18px] tw-text-base tw-font-bold tw-flex tw-items-center tw-justify-center md:tw-w-fit tw-w-full hover:!tw-bg-custom-gradient-hover'
      -%}
    </div>
        </div>
        {%- if show_quick_add -%}
          <div class="quick-add no-js-hidden !tw-hidden">
            {%- liquid
              assign product_form_id = 'quick-add-' | append: section_id | append: card_product.id
              assign qty_rules = false
              if card_product.selected_or_first_available_variant.quantity_rule.min > 1 or card_product.selected_or_first_available_variant.quantity_rule.max != null or card_product.selected_or_first_available_variant.quantity_rule.increment > 1
                assign qty_rules = true
              endif
            -%}
            {%- if card_product.variants.size > 1 or qty_rules -%}
              <modal-opener data-modal="#QuickAdd-{{ card_product.id }}">
                <button
                  id="{{ product_form_id }}-submit"
                  type="submit"
                  name="add"
                  class="quick-add__submit button button--full-width button--secondary{% if horizontal_quick_add %} card--horizontal__quick-add animate-arrow{% endif %}"
                  aria-haspopup="dialog"
                  aria-labelledby="{{ product_form_id }}-submit title-{{ section_id }}-{{ card_product.id }}"
                  data-product-url="{{ card_product.url }}"
                >
                  {{ 'products.product.choose_options' | t }}
                  {%- if horizontal_quick_add -%}
                    <span class="icon-wrap">{% render 'icon-arrow' %}</span>
                  {%- endif -%}
                  <div class="loading-overlay__spinner hidden">
                    <svg
                      aria-hidden="true"
                      focusable="false"
                      class="spinner"
                      viewBox="0 0 66 66"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <circle class="path" fill="none" stroke-width="6" cx="33" cy="33" r="30"></circle>
                    </svg>
                  </div>
                </button>
              </modal-opener>
              <quick-add-modal id="QuickAdd-{{ card_product.id }}" class="quick-add-modal">
                <div
                  role="dialog"
                  aria-label="{{ 'products.product.choose_product_options' | t: product_name: card_product.title | escape }}"
                  aria-modal="true"
                  class="quick-add-modal__content global-settings-popup"
                  tabindex="-1"
                >
                  <button
                    id="ModalClose-{{ card_product.id }}"
                    type="button"
                    class="quick-add-modal__toggle"
                    aria-label="{{ 'accessibility.close' | t }}"
                  >
                    {% render 'icon-close' %}
                  </button>
                  <div id="QuickAddInfo-{{ card_product.id }}" class="quick-add-modal__content-info"></div>
                </div>
              </quick-add-modal>
            {%- else -%}
              <product-form>
                {%- form 'product',
                  card_product,
                  id: product_form_id,
                  class: 'form',
                  novalidate: 'novalidate',
                  data-type: 'add-to-cart-form'
                -%}
                  <input
                    type="hidden"
                    name="id"
                    value="{{ card_product.selected_or_first_available_variant.id }}"
                    disabled
                  >
                  <button
                    id="{{ product_form_id }}-submit"
                    type="submit"
                    name="add"
                    class="quick-add__submit button button--full-width button--secondary{% if horizontal_quick_add %} card--horizontal__quick-add{% endif %}"
                    aria-haspopup="dialog"
                    aria-labelledby="{{ product_form_id }}-submit title-{{ section_id }}-{{ card_product.id }}"
                    aria-live="polite"
                    data-sold-out-message="true"
                    {% if card_product.selected_or_first_available_variant.available == false %}
                      disabled
                    {% endif %}
                  >
                    <span>
                      {%- if card_product.selected_or_first_available_variant.available -%}
                        {{ 'products.product.add_to_cart' | t }}
                      {%- else -%}
                        {{ 'products.product.sold_out' | t }}
                      {%- endif -%}
                    </span>
                    <span class="sold-out-message hidden">
                      {{ 'products.product.sold_out' | t }}
                    </span>
                    {%- if horizontal_quick_add -%}
                      <span class="icon-wrap">{% render 'icon-plus' %}</span>
                    {%- endif -%}
                    <div class="loading-overlay__spinner hidden">
                      <svg
                        aria-hidden="true"
                        focusable="false"
                        class="spinner"
                        viewBox="0 0 66 66"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <circle class="path" fill="none" stroke-width="6" cx="33" cy="33" r="30"></circle>
                      </svg>
                    </div>
                  </button>
                {%- endform -%}
              </product-form>
            {%- endif -%}
          </div>
        {%- endif -%}
        <div class="card__badge {{ settings.badge_position }}">
          {%- if card_product.available == false -%}
            <span
              id="Badge-{{ section_id }}-{{ card_product.id }}"
              class="badge badge--bottom-left color-{{ settings.sold_out_badge_color_scheme }}"
            >
              {{- 'products.product.sold_out' | t -}}
            </span>
          {%- elsif card_product.compare_at_price > card_product.price and card_product.available -%}
            {% assign q4_discount_percentage = settings.sale_q4_discount_amount %}
            {% assign base_price = card_product.price %}
            {% assign compare_at = card_product.compare_at_price %}
            {% if settings.show_q4_sale and q4_discount_percentage > 0 %}
              {% assign q4_extra_discount = base_price | times: q4_discount_percentage | divided_by: 100 %}
              {% assign q4_discounted_price = base_price | minus: q4_extra_discount %}
              {% assign savings_base = base_price %}
              {% if compare_at > base_price %}
                {% assign savings_base = compare_at %}
              {% endif %}
              {% assign total_savings = savings_base | minus: q4_discounted_price %}
            {% else %}
              {% assign total_savings = compare_at | minus: base_price %}
            {% endif %}
            <span
              id="Badge-{{ section_id }}-{{ card_product.id }}"
              class="badge badge--bottom-left color-{{ settings.sale_badge_color_scheme }}"
            >
              SAVE&nbsp;{{ total_savings | money }}
            </span>
          {%- endif -%}
        </div>
      </div>
    </div>
  </div>
{%- else -%}
  <div class="product-card-wrapper card-wrapper underline-links-hover">
    <div
      class="
        card
        card--{{ settings.card_style }}
        card--text
        {% if extend_height %} card--extend-height{% endif %}
        {% if settings.card_style == 'card' %} color-{{ settings.card_color_scheme }} gradient{% endif %}
        {% if card_product.featured_media == nil and settings.card_style == 'card' %} ratio{% endif %}
        {{ horizontal_class }}
      "
      style="--ratio-percent: 100%;"
    >
      <div
        class="card__inner {% if settings.card_style == 'standard' %}color-{{ settings.card_color_scheme }} gradient{% endif %}{% if settings.card_style == 'standard' %} ratio{% endif %}"
        style="--ratio-percent: 100%;"
      >
        <div class="card__content">
          <div class="card__information">
            <h3 class="card__heading">
              <a role="link" aria-disabled="true" class="full-unstyled-link">
                {{ 'onboarding.product_title' | t }}
              </a>
            </h3>
          </div>
        </div>
      </div>
      <div class="card__content">
        <div class="card__information">
          <h3 class="card__heading{% if settings.card_style == 'standard' %} h5{% endif %}">
            <a role="link" aria-disabled="true" class="full-unstyled-link">
              {{ 'onboarding.product_title' | t }}
            </a>
          </h3>
          <div class="card-information">
            {%- if show_vendor -%}
              <span class="visually-hidden">{{ 'accessibility.vendor' | t }}</span>
              <div class="caption-with-letter-spacing light">{{ 'products.product.vendor' | t }}</div>
            {%- endif -%}
            {% render 'price' %}
          </div>
        </div>
        <div class="button-hover-container">
      {%- assign product_form_id = 'product-form-' | append: section.id -%}
      {%- render 'buy-buttons',
        product: card_product,
        product_form_id: product_form_id,
        section_id: section.id,
        show_pickup_availability: true,
        custom_classes: 'md:tw-py-4 md:tw-px-[40px] tw-p-2 tw-gap-2.5 tw-rounded-[10px] tw-opacity-100 tw-bg-custom-gradient tw-text-white md:tw-text-[18px] tw-text-base tw-font-bold tw-flex tw-items-center tw-justify-center md:tw-w-fit tw-w-full hover:!tw-bg-custom-gradient-hover'
      -%}
    </div>
      </div>
    </div>
  </div>
{%- endif -%}
